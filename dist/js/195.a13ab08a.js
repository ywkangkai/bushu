"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[195],{9195:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-calendar"}),t._v(" CICD")]),i("el-breadcrumb-item",[t._v("工程列表")])],1)],1),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:t.delAll}},[t._v("批量删除")]),i("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"按工程名称搜索"},model:{value:t.select_word,callback:function(e){t.select_word=e},expression:"select_word"}}),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1),i("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,border:"",stripe:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),i("el-table-column",{attrs:{type:"index",label:"序号",width:"55",align:"center"}}),i("el-table-column",{attrs:{prop:"name",label:"工程名称",width:"250"}}),i("el-table-column",{attrs:{prop:"git",label:"git仓库",width:"250"}}),i("el-table-column",{attrs:{prop:"server",label:"服务地址",width:"250"}}),i("el-table-column",{attrs:{prop:"type",label:"工程类型",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"send",label:"是否发送通知",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"address",label:"企业微信地址",width:"100",align:"center"}}),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.normal?i("el-button",{attrs:{type:"text",icon:"el-icon-refresh-right"},on:{click:function(i){return t.handleBuild(e.$index,e.row)}}},[t._v("构建")]):t._e(),t.build?i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.handleBuild(e.$index,e.row)}}},[i("i",{staticClass:"el-icon-loading"}),t._v("构建")]):t._e(),i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){return t.linkTo(e.row.id)}}},[t._v("编辑")]),i("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:t.views}},[t._v("详情")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){return t.handleDelete(e.$index,e.row)}}},[t._v("删除")]),i("el-dialog",{attrs:{title:"构建流程",visible:t.dialogVisible,width:"80%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-steps",{attrs:{"align-center":""}},[i("el-step",{attrs:{status:e.row.status.git_status1,title:e.row.status.git,icon:"el-icon-loading",description:e.row.status.git_description}}),i("el-step",{attrs:{status:e.row.status.build_before_status2,title:e.row.status.build_before,icon:"el-icon-loading",description:e.row.status.build_before_description}}),i("el-step",{attrs:{status:e.row.status.structure_status3,title:e.row.status.structure,icon:"el-icon-loading",description:e.row.status.structure_description}}),i("el-step",{attrs:{status:e.row.status.build_after_status4,title:e.row.status.build_after,icon:"el-icon-loading",description:e.row.status.build_after_description}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"","page-sizes":[4,5,8,10,20],layout:"total, sizes, prev, pager, next, jumper",total:t.total_nums,"page-size":t.page_size},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)],1),i("el-dialog",{attrs:{title:"删除接口",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[i("div",{staticClass:"del-dialog-cnt"},[t._v("删除不可恢复，是否确定删除？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.delVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.deleteRow}},[t._v("确 定")])],1)])],1)},n=[],r=i(2552),a={name:"basetable",data(){return{tableData:[],cur_page:1,page_size:10,total_nums:1,multipleSelection:[],select_word:"",del_list:[],editVisible:!1,delVisible:!1,runVisible:!1,form:{},idx:-1,id:-1,env_id:"",envs_id_names:[],fullscreenLoading:!1,normal:!0,build:!1,is_build:!1,dialogVisible:!1,active:1,git:"",build_before:"",structure:"",build_after:"",git_status1:"",build_before_status2:"",structure_status3:"",build_after_status4:"",git_description:"",build_before_description:"",structure_description:"",build_after_description:""}},created(){this.getData()},methods:{handleCurrentChange(t){this.cur_page=t,this.getData()},handleSizeChange(t){this.page_size=t,this.getData()},getData(){(0,r.Kh)({page:this.cur_page,size:this.page_size}).then((t=>{this.tableData=t.data.results,this.cur_page=t.data.current_page_num||1,this.total_nums=t.data.count||1}))},search(){(0,r.lO)({name:this.select_word}).then((t=>{this.tableData=t.data.results}))},formatter(t,e){return t.address},filterTag(t,e){return e.tag===t},handleEdit(t,e){this.idx=t,this.id=e.id,this.form=e,this.editVisible=!0},async handleBuild(t,e){if(!0===this.build)return void this.$message.warning("当前已有任务在构建中, 请稍等......");this.$message.info("任务构建已开始，请在详情中查看......"),this.build=!0,this.normal=!1,this.idx=t,this.id=e.id,e.status.git_status1="finish",e.status.git="进行中",e.status.git_description="正在拉取代码",e.status.build_before_status2="wait",e.status.build_before_description="未开始";let i=await(0,r.RD)({id:this.id}),s=new RegExp("文件夹"),n=s.test(i.data.message),a=new RegExp("already exists and is not an empty directory"),u=a.test(i.data.message);if("项目拉取完成"===i.data.message)e.status.git_status1="success",e.status.build_before_status2="finish",e.status.git="已完成",e.status.build_before="进行中",e.status.git_description="代码已存在服务区指定路径中",e.status.build_before_description="执行构建步骤",this.normal=!0,this.build=!1;else{if("服务器链接失败"===i.data.message)return e.status.git_status1="error",e.status.git="已完成",e.status.git_description="服务器链接失败",this.normal=!0,void(this.build=!1);if(n)return e.status.git_status1="error",e.status.git="已完成",e.status.git_description=i.data.message,this.normal=!0,void(this.build=!1);if(u)return e.status.git_status1="error",e.status.git="已完成",e.status.git_description=i.data.message,void(this.normal=!0)}let o=await(0,r.QG)({id:this.id});"构建前步骤执行完成"===o.data.message?(e.status.build_before_status2="success",e.status.build_before="已完成",e.status.build_before_description="构建前步骤执行完成",e.status.build_after="进行中",e.status.build_after_status4="finish",e.status.build_after_description="执行构建后操作"):"服务器链接失败"===o.data.message?(e.status.build_before_status2="error",e.status.build_before="已完成",e.status.build_before_description="服务器链接失败"):"构建前步骤失败"===o.data.message&&(e.status.build_before_status2="error",e.status.build_before="已完成",e.status.build_before_description="构建前步骤执行失败")},handleDelete(t,e){this.idx=t,this.id=e.id,this.delVisible=!0},delAll(){(0,r.tc)({idlist:this.del_list}).then((t=>{this.$message.success("删除成功"),this.tableData=t.data.results})).catch((t=>{this.$message.error("服务器错误")}))},handleSelectionChange(t){let e=t,i=[];for(var s=0;s<e.length;s++)i.push(e[s]["id"]);this.del_list=i},deleteRow(){(0,r.cQ)(this.id).then((t=>{this.$message.success("删除成功"),this.delVisible=!1,this.tableData=t.data.results,this.cur_page=t.data.current_page_num||1,this.total_nums=t.data.count||1})).catch((t=>{this.$message.error("服务器错误")}))},linkTo(t){this.$router.push({path:`/font_edit/${t}`})},handleClose(t){t()},views(){this.dialogVisible=!0}}},u=a,o=i(1001),l=(0,o.Z)(u,s,n,!1,null,"6b8a7f96",null),c=l.exports},2552:function(t,e,i){i.d(e,{$8:function(){return et},$q:function(){return q},AH:function(){return ut},AZ:function(){return m},B:function(){return d},Bx:function(){return G},Cs:function(){return U},DC:function(){return L},Dr:function(){return ct},FP:function(){return _},G3:function(){return F},GL:function(){return dt},GW:function(){return vt},IG:function(){return b},KL:function(){return it},Kh:function(){return $t},Kq:function(){return mt},L$:function(){return c},LO:function(){return z},Lu:function(){return Y},NM:function(){return rt},NV:function(){return o},NW:function(){return V},OM:function(){return tt},PT:function(){return w},QG:function(){return kt},RB:function(){return R},RD:function(){return zt},RQ:function(){return D},Sp:function(){return _t},TR:function(){return P},Tg:function(){return ot},Tj:function(){return bt},Vx:function(){return Z},W7:function(){return I},WD:function(){return h},XC:function(){return N},Z4:function(){return A},ZH:function(){return K},Zf:function(){return v},_X:function(){return f},ah:function(){return nt},aj:function(){return C},ay:function(){return T},cQ:function(){return wt},cu:function(){return ft},d9:function(){return a},ei:function(){return at},iO:function(){return k},ie:function(){return x},in:function(){return H},jJ:function(){return g},jh:function(){return ht},kJ:function(){return pt},kq:function(){return X},lO:function(){return Ct},n:function(){return p},nL:function(){return j},nk:function(){return B},nq:function(){return $},ny:function(){return W},o:function(){return S},pU:function(){return J},pW:function(){return gt},s2:function(){return lt},tK:function(){return y},tc:function(){return yt},th:function(){return l},vi:function(){return st},vj:function(){return O},x4:function(){return u},xQ:function(){return Q},yr:function(){return E},z:function(){return M}});var s=i(4206),n=i.n(s);let r="http://kk.uoyo.net:8080";const a=t=>n().get(`${r}/project/list/?page=`+t.page+"&size="+t.size,t),u=t=>n().post(`${r}/project/detail/`,t),o=(t,e)=>n().put(`${r}/project/edit/`+t+"/",e),l=t=>n()["delete"](`${r}/project/delete/`+t+"/"),c=t=>n().post(`${r}/project/deleteall/`,t),d=t=>n().post(`${r}/project/add/`,t),p=()=>n().get(`${r}/interface/project/name`),f=()=>n().get(`${r}/project/get/env/`),g=t=>n().post(`${r}/project/run/`,t),b=t=>n().post(`${r}/interface/add/`,t),_=t=>n().get(`${r}/interface/list/?page=`+t.page+"&size="+t.size,t),h=(t,e)=>n().put(`${r}/interface/edit/`+t+"/",e),$=t=>n()["delete"](`${r}/interface/delete/`+t+"/"),m=t=>n().post(`${r}/interface/deleteall/`,t),v=t=>n().post(`${r}/interface/detail/`,t),w=()=>n().get(`${r}/interface/env/`),y=t=>n().post(`${r}/interface/run/`,t),C=t=>n().get(`${r}/env/list/?page=`+t.page+"&size="+t.size,t),z=(t,e)=>n().put(`${r}/env/edit/`+t+"/",e),k=t=>n()["delete"](`${r}/env/delete/`+t+"/"),x=t=>n().post(`${r}/env/add/`,t),j=t=>n().post(`${r}/env/detail/`,t),D=t=>n().post(`${r}/env/deleteall/`,t),V=t=>n().get(`${r}/debugtalk/list/?page=`+t.page+"&size="+t.size,t),R=t=>n().post(`${r}/debugtalk/detail/`,t),T=t=>n().get(`${r}/debugtalk/code/`+t+"/"),L=t=>n().put(`${r}/debugtalk/update/`,t),S=()=>n().get(`${r}/config/project/name/`),B=t=>n().post(`${r}/config/interface/name/`,t),G=t=>n().post(`${r}/config/save/`,t),Q=t=>n().get(`${r}/config/list/?page=`+t.page+"&size="+t.size,t),K=t=>n().post(`${r}/config/detail/`,t),O=t=>n()["delete"](`${r}/config/delete/`+t+"/"),W=t=>n().post(`${r}/config/deleteall/`,t),Z=t=>n().get(`${r}/config/detail/`+t+"/"),q=(t,e)=>n().put(`${r}/config/update/`+t+"/",e),A=()=>n().get(`${r}/testsuite/project/name/`),E=t=>n().post(`${r}/testsuite/interface/name/`,t),N=t=>n().post(`${r}/testsuite/add/`,t),H=t=>n().get(`${r}/testsuite/list/?page=`+t.page+"&size="+t.size,t),I=t=>n().post(`${r}/testsuite/detail/`,t),J=t=>n().get(`${r}/testsuite/detail/`+t+"/"),M=(t,e)=>n().put(`${r}/testsuite/update/`+t+"/",e),P=t=>n().post(`${r}/testsuite/deleteall/`,t),X=t=>n()["delete"](`${r}/testsuite/delete/`+t+"/"),F=()=>n().get(`${r}/testcase/project/name/`),U=t=>n().post(`${r}/testcase/interface/name/`,t),Y=t=>n().post(`${r}/testcase/configure/name/`,t),tt=t=>n().post(`${r}/testcase/name/`,t),et=t=>n().post(`${r}/testcase/add/`,t),it=t=>n().get(`${r}/testcase/list/?page=`+t.page+"&size="+t.size),st=t=>n().post(`${r}/testcase/detail/`,t),nt=t=>n()["delete"](`${r}/testcase/delete/`+t+"/"),rt=t=>n().post(`${r}/testcase/deleteall/`,t),at=t=>n().get(`${r}/testcase/get/detail/`+t+"/"),ut=t=>n().put(`${r}/testcase/update/`,t),ot=()=>n().get(`${r}/testcase/get/env/`),lt=t=>n().post(`${r}/testcase/run/`,t),ct=t=>n().get(`${r}/report/list/?page=`+t.page+"&size="+t.size),dt=t=>n().get(`${r}/report/view/`+t+"/"),pt=t=>n().post(`${r}/report/download/`+t+"/"),ft=t=>n()["delete"](`${r}/report/delete/`+t+"/"),gt=t=>n().post(`${r}/report/deleteall/`,t),bt=t=>n().post(`${r}/report/open/`,t),_t=()=>n().get(`${r}/summary/data/`),ht=t=>n().post(`${r}/repository/add/`,t),$t=t=>n().get(`${r}/repository/list/?page=`+t.page+"&size="+t.size),mt=t=>n().post(`${r}/repository/detail/`,t),vt=t=>n().put(`${r}/repository/update/`,t),wt=t=>n()["delete"](`${r}/repository/delete/`+t+"/"),yt=t=>n().post(`${r}/repository/deleteall/`,t),Ct=t=>n().post(`${r}/repository/search/`,t),zt=t=>n().post(`${r}/repository/git/`,t),kt=t=>n().post(`${r}/repository/compile/`,t)}}]);
//# sourceMappingURL=195.a13ab08a.js.map