"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[834],{7834:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 用例管理")]),a("el-breadcrumb-item",[e._v("新增用例")])],1)],1),a("div",{staticClass:"container"},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"基本信息"}},[a("div",{staticClass:"form-box"},[a("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"选择项目"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getInterfacesByProjectID(e.selected_project_id)}},model:{value:e.selected_project_id,callback:function(t){e.selected_project_id=t},expression:"selected_project_id"}},e._l(e.project_names,(function(e,t){return a("el-option",{key:t,attrs:{label:e.projectname,value:e.id}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择接口"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getConfTestcaseByInterfaceID(e.selected_interface_id)}},model:{value:e.selected_interface_id,callback:function(t){e.selected_interface_id=t},expression:"selected_interface_id"}},e._l(e.interfaces,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择配置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selected_configure_id,callback:function(t){e.selected_configure_id=t},expression:"selected_configure_id"}},e._l(e.configures,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:100}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"drag-box-item"},[a("div",{staticClass:"item-title"},[e._v("待选前置用例")]),a("draggable",{attrs:{options:e.dragOptions},on:{change:function(t){return e.unchangeResult()}},model:{value:e.unselected,callback:function(t){e.unselected=t},expression:"unselected"}},[a("transition-group",{staticClass:"item-ul",attrs:{tag:"div"}},e._l(e.unselected,(function(t){return a("div",{key:t.id,staticClass:"drag-list"},[e._v(" "+e._s(t.name)+" ")])})),0)],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"drag-box-item"},[a("div",{staticClass:"item-title"},[e._v("已选前置用例")]),a("draggable",{attrs:{options:e.dragOptions},on:{change:function(t){return e.changeResult()}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("transition-group",{staticClass:"item-ul",attrs:{tag:"div"}},e._l(e.selected,(function(t){return a("div",{key:t.id,staticClass:"drag-list"},[e._v(" "+e._s(t.name)+" ")])})),0)],1)],1)])],1)],1)],1)]),a("el-tab-pane",{attrs:{label:"请求信息"}},[a("el-form",{staticStyle:{margin:"0 0 0 10px"}},[a("el-form-item",[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"80%","margin-right":"5px"},attrs:{placeholder:"请填写请求地址"},model:{value:e.apiMsgData.url,callback:function(t){e.$set(e.apiMsgData,"url",t)},expression:"apiMsgData.url"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",size:"medium",placeholder:"选择请求方式"},slot:"prepend",model:{value:e.apiMsgData.method,callback:function(t){e.$set(e.apiMsgData,"method",t)},expression:"apiMsgData.method"}},e._l(e.methods,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})})),1),a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:function(t){e.ParamViewStatus=!e.ParamViewStatus}},slot:"append"},[e._v(" Params ")])],1),[a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"当请求为GET时，点击params添加参数"}},[a("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])]],2)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:this.ParamViewStatus,expression:"this.ParamViewStatus"}],staticStyle:{width:"98.2%","margin-top":"-20px",left:"10px"},attrs:{data:e.apiMsgData.param,"row-style":{"background-color":"rgb(250, 250, 250)"},size:"mini","show-header":!1}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"value",id:"param_input"+t.$index,type:"textarea",rows:"1",resize:"none"},on:{focus:function(a){return e.showLine("param_input",t.$index)},input:function(t){return e.changeLine()},blur:function(a){return e.resetLine(t.$index)}},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("param",t.$index)}}})]}}])})],1),a("el-tabs",{staticStyle:{margin:"0 0 0 10px"},model:{value:e.bodyShow,callback:function(t){e.bodyShow=t},expression:"bodyShow"}},[a("el-tab-pane",{attrs:{label:"Headers",name:"first"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.header,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("header",t.$index)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Body",name:"second",disabled:"GET"===e.apiMsgData.method}},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-radio-group",{model:{value:e.apiMsgData.choiceType,callback:function(t){e.$set(e.apiMsgData,"choiceType",t)},expression:"apiMsgData.choiceType"}},[a("el-radio",{attrs:{label:"data"}},[e._v("form-data")]),a("el-radio",{attrs:{label:"json"}},[e._v("json")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"json"===e.apiMsgData.choiceType,expression:"apiMsgData.choiceType === 'json'"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.formatData()}}},[e._v("格式化 ")])],1),a("hr",{staticStyle:{height:"1px",border:"none","border-top":"1px solid rgb(241, 215, 215)"}}),"json"===e.apiMsgData.choiceType?a("div",[a("div",{staticStyle:{border:"1px solid rgb(234, 234, 234)"}},[a("el-container",[a("editor",{directives:[{name:"contextmenu",rawName:"v-contextmenu:contextmenu",arg:"contextmenu"}],staticStyle:{"font-size":"15px"},attrs:{lang:"json",theme:"chrome",width:"100%",height:"575px",options:{}},on:{init:e.editorInit},model:{value:e.apiMsgData.jsonVariable,callback:function(t){e.$set(e.apiMsgData,"jsonVariable",t)},expression:"apiMsgData.jsonVariable"}})],1)],1)]):e._e(),"data"===e.apiMsgData.choiceType?a("el-table",{staticStyle:{"background-color":"rgb(250, 250, 250)"},attrs:{data:e.apiMsgData.variable,size:"mini",stripe:"","show-header":!1,height:"500","row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}],null,!1,1066183472)}),a("el-table-column",{attrs:{label:"type","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini"},model:{value:t.row.param_type,callback:function(a){e.$set(t.row,"param_type",a)},expression:"scope.row.param_type"}},e._l(e.paramTypes,(function(e){return a("el-option",{key:e,attrs:{value:e}})})),1)]}}],null,!1,2916901183)}),a("el-table-column",{attrs:{label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{id:"data_input"+t.$index,type:"textarea",rows:"1",size:"mini",resize:"none",placeholder:"value"},on:{focus:function(a){return e.showLine("data_input",t.$index)},input:function(t){return e.changeLine()},blur:function(t){return e.resetLine()}},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})],1)]}}],null,!1,78841193)}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("variable",t.$index)}}})]}}],null,!1,3617919201)})],1):e._e()],1),a("el-tab-pane",{attrs:{label:"Extract",name:"third"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.extract,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("extract",t.$index)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Assert",name:"fourth"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.validate,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"check"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{label:"Comparator","header-align":"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请选择",size:"mini"},model:{value:t.row.comparator,callback:function(a){e.$set(t.row,"comparator",a)},expression:"scope.row.comparator"}})]}}])}),a("el-table-column",{attrs:{label:"type","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini"},model:{value:t.row.param_type,callback:function(a){e.$set(t.row,"param_type",a)},expression:"scope.row.param_type"}},e._l(e.paramTypes,(function(e){return a("el-option",{key:e,attrs:{value:e}})})),1)]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"expect"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("validate",t.$index)}}})]}}])})],1)],1)],1)],1),a("el-tab-pane",{attrs:{label:"环境变量|参数化|请求钩子"}},[a("el-tabs",{staticStyle:{margin:"0 0 0 10px"},model:{value:e.otherShow,callback:function(t){e.otherShow=t},expression:"otherShow"}},[a("el-tab-pane",{attrs:{label:"环境变量",name:"first"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.globalVar,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{label:"type","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"mini"},model:{value:t.row.param_type,callback:function(a){e.$set(t.row,"param_type",a)},expression:"scope.row.param_type"}},e._l(e.paramTypes,(function(e){return a("el-option",{key:e,attrs:{value:e}})})),1)]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("globalVar",t.$index)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"参数化",name:"second"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.parameterized,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key 或者 key1-key2-key3"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:'["value1", "value2] 或者 [["v1", "v2", "v3"],["v11","v22", "v33"]] 或者 ${函数名(参数, 参数, ...)}'},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("parameterized",t.$index)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"setup_hooks",name:"third"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.setupHooks,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("setupHooks",t.$index)}}})]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"teardown_hooks",name:"fourth"}},[a("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.teardownHooks,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),a("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(a){return e.delTableRow("teardownHooks",t.$index)}}})]}}])})],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("提交")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{on:{click:e.resetFor}},[e._v("取消")])],1)],1)],1),a("el-dialog",{attrs:{title:"创建用例",visible:e.editVisible,width:"28%",center:""},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用例名称",required:""}},[a("el-input",{attrs:{clearable:""},model:{value:e.testcase_name,callback:function(t){e.testcase_name=t},expression:"testcase_name"}})],1),a("el-form-item",{attrs:{label:"测试人员",required:""}},[a("el-input",{attrs:{clearable:""},model:{value:e.author,callback:function(t){e.author=t},expression:"author"}})],1),a("el-form-item",{attrs:{label:"选择项目",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getInterfacesByProjectID(e.selected_project_id)}},model:{value:e.selected_project_id,callback:function(t){e.selected_project_id=t},expression:"selected_project_id"}},e._l(e.project_names,(function(e,t){return a("el-option",{key:t,attrs:{label:e.projectname,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"选择接口",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selected_interface_id,callback:function(t){e.selected_interface_id=t},expression:"selected_interface_id"}},e._l(e.interfaces,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},s=[],r=a(9726),i=(a(561),a(4916),a(7601),a(9653),a(3123),a(3210),a(8862),a(9600),a(9980)),n=a.n(i),o=a(2552),u={name:"baseform",data:function(){return{editVisible:!1,methods:["POST","GET","PUT","DELETE"],types:["data","json","params"],ParamViewStatus:!1,comparators:[{value:"equals"},{value:"contains"},{value:"contained_by"},{value:"startswith"},{value:"endswith"},{value:"regex_match"},{value:"less_than"},{value:"less_than_or_equals"},{value:"greater_than"},{value:"greater_than_or_equals"},{value:"not_equals"},{value:"string_equals"},{value:"length_equals"},{value:"length_greater_than"},{value:"count_greater_than_or_equals"},{value:"length_less_than"},{value:"length_less_than_or_equals"}],apiMsgData:{id:null,method:"POST",name:"",url:"",choiceType:"json",param:[{key:null,value:null}],header:[{key:null,value:null}],variable:[{key:null,value:null,param_type:"string"}],jsonVariable:"",extract:[{key:null,value:null}],validate:[{key:null,value:null,comparator:"equals",param_type:"string"}],globalVar:[{key:null,value:null,param_type:"string"}],parameterized:[{key:null,value:null}],setupHooks:[{key:null}],teardownHooks:[{key:null}]},bodyShow:"second",otherShow:"first",paramTypes:["string","int","float","boolean"],cell:Object(),dragOptions:{animation:120,scroll:!0,group:"sortlist",ghostClass:"ghost-style"},project_names:[],selected_project_id:null,selected_interface_id:null,selected_configure_id:null,selected_testcase_id:[],unselected_testcase_id:[],testcase_name:null,author:"",interfaces:[],configures:[],unselected:[],selected:[]}},created:function(){this.getProjectNames()},components:{draggable:n(),editor:a(3251)},methods:{editorInit:function(){a(5335),a(8750),a(2298),a(8055)},resetFor:function(){this.$router.push("/testcases_list")},onSubmit:function(){if(0!==this.apiMsgData.url.length){var e=this.apiMsgData.validate;e.splice(-1,1),0!==e.length?(this.selected_project_id=null,this.selected_interface_id=null,this.editVisible=!0):this.$message.error("未设置Assert断言!")}else this.$message.error("没有输入请求URL")},handleData1:function(e,t){for(var a={},l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];var r=e[l].param_type,i=e[l].value;if("int"===r){if(!/^\d+$/.test(i))return this.$message.error(t+"不是整数int类型!"),[];i=Number(i)}else if("float"===r){if(!/^[+-]?\d+(\.\d+)?$/.test(i))return this.$message.error(t+"不是小数float类型!"),[];i=Number(i)}else if("boolean"===r)if(/^(true|True|TRUE|1)$/.test(i))i=!0;else{if(!/^(false|False|FALSE|0)$/.test(i))return this.$message.error(t+"不是布尔boolean类型!"),[];i=!1}a[s]=i}return a},handleData11:function(e,t){for(var a=[],l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];var r=e[l].param_type,i=e[l].value;if("int"===r){if(!/^\d+$/.test(i))return this.$message.error(t+"不是整数int类型!"),[];i=Number(i)}else if("float"===r){if(!/^[+-]?\d+(\.\d+)?$/.test(i))return this.$message.error(t+"不是小数float类型!"),[];i=Number(i)}else if("boolean"===r)if(/^(true|True|TRUE|1|0)$/.test(i))i=!0;else{if(!/^(false|False|FALSE|0)$/.test(i))return this.$message.error(t+"不是布尔boolean类型!"),[];i=!1}var n={};n[s]=i,a.push(n)}return a},handleData2:function(e,t){for(var a={},l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];a[s]=e[l].value}return a},handleData22:function(e,t){for(var a=[],l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];var r=e[l].value,i={};/^\[/.test(r)&&(r=JSON.parse(r)),i[s]=r,a.push(i)}return a},handleData3:function(e,t){for(var a=[],l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];a.push(s)}return a},handleData4:function(e,t){for(var a=[],l=0;l<e.length;l++){var s=e[l].key;if(!s)return this.$message.error(t+"的key为空!"),[];var r=e[l].param_type,i=e[l].value,n=e[l].comparator;if("int"===r){if(!/^\d+$/.test(i))return this.$message.error(t+"不是整数int类型!"),[];i=Number(i)}else if("float"===r){if(!/^[+-]?\d+(\.\d+)?$/.test(i))return this.$message.error(t+"不是小数float类型!"),[];i=Number(i)}else if("boolean"===r)if(/^(true|True|TRUE|1|0)$/.test(i))i=!0;else{if(!/^(false|False|FALSE|0)$/.test(i))return this.$message.error(t+"不是布尔boolean类型!"),[];i=!1}var o={};o["check"]=s,o["expect"]=i,o["comparator"]=n,a.push(o)}return a},saveEdit:function(){var e=this;if(""!==this.testcase_name)if(""!==this.author)if(null!==this.selected_project_id&&null!==this.selected_interface_id){var t={config:this.selected_configure_id,testcases:this.selected_testcase_id,untestcases:this.unselected_testcase_id},a=this.apiMsgData.url.trim().split("?",1)[0],l={name:this.testcase_name,include:t,interface:{pid:this.selected_project_id,iid:this.selected_interface_id},author:this.author,request:{test:{name:this.testcase_name,request:{url:a,method:this.apiMsgData.method}}}},s=this.apiMsgData.param;if(s.splice(-1,1),0!==s.length){var i=this.handleData2(s,"param参数");if(0===i.length)return;l.request.test.request["params"]=i}var n=null;if("json"===this.apiMsgData.choiceType)"json",n=this.apiMsgData.jsonVariable,0!==n.length&&(l.request.test.request["json"]=JSON.parse(n));else if("data",n=this.apiMsgData.variable,n.splice(-1,1),0!==n.length){var u=this.handleData1(n,"form-data参数");if(0===u.length)return;l.request.test.request["data"]=u}var c=this.apiMsgData.parameterized;if(c.splice(-1,1),0!==c.length){var p=this.handleData22(c,"参数化参数");if(0===p.length)return;l.request.test["parameters"]=p}var d=this.apiMsgData.globalVar;if(d.splice(-1,1),0!==d.length){var h=this.handleData11(d,"全局变量variables");if(0===h.length)return;l.request.test["variables"]=h}var g=this.apiMsgData.header;if(g.splice(-1,1),0!==g.length){var m=this.handleData2(g,"请求头header");if(0===m.length)return;l.request.test.request["headers"]=m}var f=this.apiMsgData.extract;if(f.splice(-1,1),0!==f.length){var b=this.handleData22(f,"extract参数");if(0===b.length)return;l.request.test["extract"]=b}var v=this.apiMsgData.validate;if(v.splice(-1,1),0!==v.length){var y=this.handleData4(v,"Assert断言参数");if(0!==y.length){l.request.test["validate"]=y;var k=this.apiMsgData.setupHooks;if(k.splice(-1,1),0!==k.length){var _=this.handleData3(k,"请求钩子setup_hooks");if(0===_.length)return;l.request.test["setup_hooks"]=_}var w=this.apiMsgData.teardownHooks;if(w.splice(-1,1),0!==w.length){var D=this.handleData3(w,"请求钩子teardown_hooks");if(0===D.length)return;l.request.test["teardown_hooks"]=D}l.include=JSON.stringify(l.include),l.request=JSON.stringify(l.request),(0,o.$8)(l).then((function(t){e.editVisible=!1;var a=e;e.$message.success("新增用例成功"),setInterval((function(){a.$router.go()}),1e3)})).catch((function(t){e.editVisible=!1,"object"===(0,r.Z)(t)&&t.hasOwnProperty("name")?(console.log(t),e.$message.error("用例名称已存在")):(console.log(t),e.$message.error("服务器错误"))}))}}else this.$message.error("未设置Assert断言!")}else this.$message.error("未选择所属项目或者接口!");else this.$message.error("测试人员名称不能为空!");else this.$message.error("用例名称不能为空!")},getProjectNames:function(){var e=this;(0,o.G3)().then((function(t){e.project_names=t.data.data})).catch((function(e){that.$message.error("服务器错误")}))},getInterfacesByProjectID:function(e){var t=this;(0,o.Cs)({id:e}).then((function(e){t.interfaces=e.data.data})).catch((function(e){that.$message.error("服务器错误")}))},getConfTestcaseByInterfaceID:function(e){var t=this;(0,o.Lu)({id:e}).then((function(e){t.configures=e.data.data})).catch((function(e){that.$message.error("服务器错误")})),(0,o.OM)({id:e}).then((function(e){t.unselected=e.data.data})).catch((function(e){that.$message.error("服务器错误")}))},changeResult:function(){for(var e=this.selected.length,t="[",a=0;a<e;a++)t+=a===e-1?this.selected[a].id+"]":this.selected[a].id+", ";0===e&&(t="[]"),this.selected_testcase_id=JSON.parse(t)},unchangeResult:function(){for(var e=this.unselected,t=e.length,a="[",l=0;l<t;l++)a+=l===t-1?e[l].id+"]":e[l].id+", ";0===t&&(a="[]"),this.unselected_testcase_id=JSON.parse(a)},delTableRow:function(e,t){"variable"===e?this.apiMsgData.variable.splice(t,1):"header"===e?this.apiMsgData.header.splice(t,1):"validate"===e?this.apiMsgData.validate.splice(t,1):"extract"===e?this.apiMsgData.extract.splice(t,1):"param"===e?this.apiMsgData.param.splice(t,1):"globalVar"===e?this.apiMsgData.globalVar.splice(t,1):"parameterized"===e?this.apiMsgData.parameterized.splice(t,1):"setupHooks"===e?this.apiMsgData.setupHooks.splice(t,1):"teardownHooks"===e&&this.apiMsgData.teardownHooks.splice(t,1)},addTableRow:function(e){"variable"===e?this.apiMsgData.variable.push({key:null,value:null,param_type:"string"}):"header"===e?this.apiMsgData.header.push({key:null,value:null}):"validate"===e?this.apiMsgData.validate.push({key:null,value:null,comparator:"equals",param_type:"string"}):"extract"===e?this.apiMsgData.extract.push({key:null,value:null}):"param"===e?this.apiMsgData.param.push({key:null,value:null}):"globalVar"===e?this.apiMsgData.globalVar.push({key:null,value:null,param_type:"string"}):"parameterized"===e?this.apiMsgData.parameterized.push({key:null,value:null}):"setupHooks"===e?this.apiMsgData.setupHooks.push({key:null}):"teardownHooks"===e&&this.apiMsgData.teardownHooks.push({key:null})},formatData:function(){try{this.apiMsgData.jsonVariable=JSON.parse(this.apiMsgData.jsonVariable),this.apiMsgData.jsonVariable=JSON.stringify(this.apiMsgData.jsonVariable,null,4)}catch(e){this.$message({showClose:!0,message:"json格式错误",type:"warning"})}},tempNum:function(e){this.temp_num=e},resetLine:function(){this.cell.style.height="18px"},showLine:function(e,t){this.cell=document.getElementById(e+t),this.cell.style.height=this.cell.scrollHeight+"px"},changeLine:function(){if(this.cell.style.height!==this.cell.scrollHeight+"px"){var e=parseInt(this.cell.style.height.substring(0,this.cell.style.height.length-2));e-this.cell.scrollHeight===2?this.cell.style.height=e-18+"px":this.cell.style.height=this.cell.scrollHeight+"px"}},handleClick:function(){this.apiMsgData.jsonVariable=""},querySearch:function(e,t){t(this.comparators)}},computed:{monitorParam:function(){return this.apiMsgData.param},monitorUrl:function(){return this.apiMsgData.url},monitorMethod:function(){return this.apiMsgData.method},monitorVariable:function(){return this.apiMsgData.variable},monitorHeader:function(){return this.apiMsgData.header},monitorExtract:function(){return this.apiMsgData.extract},monitorValidate:function(){return this.apiMsgData.validate},monitorGlobalVar:function(){return this.apiMsgData.globalVar},monitorParameterized:function(){return this.apiMsgData.parameterized},monitorSetupHooks:function(){return this.apiMsgData.setupHooks},monitorTeardownHooks:function(){return this.apiMsgData.teardownHooks}},watch:{monitorParam:{handler:function(){(0===this.apiMsgData.param.length||this.apiMsgData.param[this.apiMsgData.param.length-1]["key"]||this.apiMsgData.param[this.apiMsgData.param.length-1]["value"])&&this.addTableRow("param");var e="";for(var t in this.apiMsgData.param)parseInt(t)+2===this.apiMsgData.param.length&&this.apiMsgData.param[t].key?this.apiMsgData.param[t].value?e+=this.apiMsgData.param[t].key+"="+this.apiMsgData.param[t].value:e+=this.apiMsgData.param[t].key:this.apiMsgData.param[t].key&&(e+=this.apiMsgData.param[t].key+"="+this.apiMsgData.param[t].value+"&");"&"===e.substr(e.length-1,1)&&(e=e.substring(0,e.length-1)),this.apiMsgData.url=e?this.apiMsgData.url.split("?")[0]+"?"+e:this.apiMsgData.url.split("?")[0]},deep:!0},monitorUrl:function(){if(this.apiMsgData.url)if(-1!==this.apiMsgData.url.indexOf("?")){var e=this.apiMsgData.url.split("?");if(e.splice(0,1),e=e.join("?"),e){var t=e.split("&");if(t[0]){this.apiMsgData.param=Array();for(var a=0;a<t.length;a++)if(-1!==t[a].indexOf("=")){var l=t[a].split("="),s=l[0];l.splice(0,1),this.apiMsgData.param.push({key:s,value:l.join("=")})}else this.apiMsgData.param.push({key:t[a],value:""})}}else this.apiMsgData.param=[{key:"",value:""}]}else this.apiMsgData.param=[{key:"",value:""}];else this.apiMsgData.param=[{key:"",value:""}]},monitorMethod:function(e){"GET"===e&&(this.bodyShow="first")},monitorVariable:{handler:function(){0===this.apiMsgData.variable.length&&this.addTableRow("variable"),(this.apiMsgData.variable[this.apiMsgData.variable.length-1]["key"]||this.apiMsgData.variable[this.apiMsgData.variable.length-1]["value"])&&this.addTableRow("variable")},deep:!0},monitorExtract:{handler:function(){0===this.apiMsgData.extract.length&&this.addTableRow("extract"),(this.apiMsgData.extract[this.apiMsgData.extract.length-1]["key"]||this.apiMsgData.extract[this.apiMsgData.extract.length-1]["value"])&&this.addTableRow("extract")},deep:!0},monitorHeader:{handler:function(){0===this.apiMsgData.header.length&&this.addTableRow("header"),(this.apiMsgData.header[this.apiMsgData.header.length-1]["key"]||this.apiMsgData.header[this.apiMsgData.header.length-1]["value"])&&this.addTableRow("header")},deep:!0},monitorValidate:{handler:function(){0===this.apiMsgData.validate.length&&this.addTableRow("validate"),(this.apiMsgData.validate[this.apiMsgData.validate.length-1]["key"]||this.apiMsgData.validate[this.apiMsgData.validate.length-1]["value"])&&this.addTableRow("validate")},deep:!0},monitorGlobalVar:{handler:function(){0===this.apiMsgData.globalVar.length&&this.addTableRow("globalVar"),(this.apiMsgData.globalVar[this.apiMsgData.globalVar.length-1]["key"]||this.apiMsgData.globalVar[this.apiMsgData.globalVar.length-1]["value"])&&this.addTableRow("globalVar")},deep:!0},monitorParameterized:{handler:function(){0===this.apiMsgData.parameterized.length&&this.addTableRow("parameterized"),(this.apiMsgData.parameterized[this.apiMsgData.parameterized.length-1]["key"]||this.apiMsgData.parameterized[this.apiMsgData.parameterized.length-1]["value"])&&this.addTableRow("parameterized")},deep:!0},monitorSetupHooks:{handler:function(){0===this.apiMsgData.setupHooks.length&&this.addTableRow("setupHooks"),this.apiMsgData.setupHooks[this.apiMsgData.setupHooks.length-1]["key"]&&this.addTableRow("setupHooks")},deep:!0},monitorTeardownHooks:{handler:function(){0===this.apiMsgData.teardownHooks.length&&this.addTableRow("teardownHooks"),this.apiMsgData.teardownHooks[this.apiMsgData.teardownHooks.length-1]["key"]&&this.addTableRow("teardownHooks")},deep:!0}}},c=u,p=a(1001),d=(0,p.Z)(c,l,s,!1,null,"905879e2",null),h=d.exports}}]);
//# sourceMappingURL=834-legacy.354b1764.js.map