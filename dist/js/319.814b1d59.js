"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[319],{2319:function(e,r,s){s.r(r),s.d(r,{default:function(){return u}});var o=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"login-wrap"},[s("div",{staticClass:"ms-login"},[s("div",{staticClass:"ms-title"},[e._v("用户注册")]),s("el-form",{ref:"ruleForm",staticClass:"ms-content",attrs:{model:e.ruleForm,rules:e.rules}},[s("el-form-item",{attrs:{prop:"username",error:e.err_username_msg}},[s("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},on:{focus:function(r){return e.clearValidate("username")}},model:{value:e.ruleForm.username,callback:function(r){e.$set(e.ruleForm,"username",r)},expression:"ruleForm.username"}},[s("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-people"},slot:"prepend"})],1)],1),s("el-form-item",{attrs:{prop:"email",error:e.err_email_msg}},[s("el-input",{attrs:{placeholder:"请输入邮箱",clearable:""},on:{focus:function(r){return e.clearValidate("email")}},model:{value:e.ruleForm.email,callback:function(r){e.$set(e.ruleForm,"email",r)},expression:"ruleForm.email"}},[s("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-mail"},slot:"prepend"})],1)],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},on:{focus:function(r){return e.clearValidate("password")}},model:{value:e.ruleForm.password,callback:function(r){e.$set(e.ruleForm,"password",r)},expression:"ruleForm.password"}},[s("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-lock"},slot:"prepend"})],1)],1),s("el-form-item",{attrs:{prop:"password_confirm"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入确认密码"},on:{focus:function(r){return e.clearValidate("password_confirm")}},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.submitForm("ruleForm")}},model:{value:e.ruleForm.password_confirm,callback:function(r){e.$set(e.ruleForm,"password_confirm",r)},expression:"ruleForm.password_confirm"}},[s("el-button",{attrs:{slot:"prepend",icon:"el-icon-lx-lock"},slot:"prepend"})],1)],1),s("el-link",{staticClass:"register_link",attrs:{type:"info",underline:!1,href:"/login"}},[e._v("已有账号？点击登录")]),s("div",{staticClass:"login-btn"},[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("注册")])],1),s("p",{directives:[{name:"show",rawName:"v-show",value:e.err_info,expression:"err_info"}],staticClass:"login-tips"},[e._v(e._s(e.err_msg))])],1)],1)])},t=[],a=(s(1703),s(9106)),l={data:function(){let e=async(e,r,s)=>{let o=r.length;if(this.err_username_msg="",o<6||o>20)s(new Error("用户名最少6位，最多20位"));else try{var t=await(0,a.Zn)(r);t.data.count>0?this.err_username_msg="用户名已存在":s()}catch(l){l.response?(this.err_username_msg="服务器错误",console.log(l.response.data),console.log(l.response.status),console.log(l.response.headers)):l.request?(this.err_username_msg=l.request,console.log(l.request)):(this.err_username_msg=l.message,console.log("Error",l.message))}},r=async(e,r,s)=>{this.err_email_msg="";var o=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,t=o.test(r.toLowerCase());t?(0,a.Zj)(r).then((e=>{e.data.count>0?this.err_email_msg="邮箱已存在":s()})).catch((e=>{e.response?(this.err_email_msg="服务器错误",console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?(this.err_email_msg=e.request,console.log(e.request)):(this.err_email_msg=e.message,console.log("Error",e.message))})):s(new Error("请输入合法的邮箱地址"))},s=(e,r,s)=>{var o=r.length;o<6||o>20?s(new Error("密码最少6位，最多20位")):(""!==this.ruleForm.password_confirm&&this.$refs.ruleForm.validateField("password_confirm"),s())},o=(e,r,s)=>{""===r?s(new Error("请输入确认密码")):r!==this.ruleForm.password?s(new Error("两次输入的密码不一致")):s()};return{ruleForm:{username:"",email:"",password:"",password_confirm:""},err_info:!1,err_msg:"",err_username_msg:"",err_email_msg:"",rules:{username:[{validator:e,trigger:"blur"}],email:[{validator:r,trigger:"blur"}],password:[{validator:s,trigger:"blur"}],password_confirm:[{validator:o,trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate((e=>{if(!e)return this.err_msg="参数有误",this.err_info=!0,!1;(0,a.z2)(this.ruleForm).then((e=>{sessionStorage.clear(),localStorage.clear(),localStorage.token=e.data.token,localStorage.username=e.data.username,localStorage.user_id=e.data.id,this.$router.push({name:"index"})})).catch((e=>{"non_field_errors"in e&&400===e.status_code&&(this.err_msg="用户名或密码错误"),e.response?this.err_msg="服务器异常":e.request&&(this.err_msg="网络异常"),this.err_info=!0}))}))},clearValidate(e){this.$refs["ruleForm"].clearValidate(e)}}},n=l,i=s(1001),m=(0,i.Z)(n,o,t,!1,null,"0aebeee4",null),u=m.exports}}]);
//# sourceMappingURL=319.814b1d59.js.map