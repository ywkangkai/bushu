"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[891],{4891:function(e,t,r){r.r(t),r.d(t,{default:function(){return c}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 配置管理")]),r("el-breadcrumb-item",[e._v("编辑配置")])],1)],1),r("div",{staticClass:"container"},[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"请求头|全局变量"}},[r("el-tabs",{staticStyle:{margin:"0 0 0 10px"},model:{value:e.otherShow,callback:function(t){e.otherShow=t},expression:"otherShow"}},[r("el-tab-pane",{attrs:{label:"Headers",name:"first"}},[r("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.header,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[r("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(r){e.$set(t.row,"key",r)},expression:"scope.row.key"}})]}}])}),r("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(r){e.$set(t.row,"value",r)},expression:"scope.row.value"}})]}}])}),r("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(r){return e.delTableRow("header",t.$index)}}})]}}])})],1)],1),r("el-tab-pane",{attrs:{label:"全局变量",name:"second"}},[r("el-table",{staticClass:"h-b-e-a-style",attrs:{data:e.apiMsgData.globalVar,size:"mini",stripe:"","show-header":!1,"row-style":{"background-color":"rgb(250, 250, 250)"}}},[r("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(r){e.$set(t.row,"key",r)},expression:"scope.row.key"}})]}}])}),r("el-table-column",{attrs:{label:"type","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{size:"mini"},model:{value:t.row.param_type,callback:function(r){e.$set(t.row,"param_type",r)},expression:"scope.row.param_type"}},e._l(e.paramTypes,(function(e){return r("el-option",{key:e,attrs:{value:e}})})),1)]}}])}),r("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center",minWidth:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(r){e.$set(t.row,"value",r)},expression:"scope.row.value"}})]}}])}),r("el-table-column",{attrs:{property:"value",label:"操作","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(r){return e.delTableRow("globalVar",t.$index)}}})]}}])})],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:2}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("更新")])],1),r("el-col",{attrs:{span:2}},[r("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("取消")])],1)],1)],1),r("el-dialog",{attrs:{title:"编辑配置",visible:e.editVisible,width:"28%",center:""},on:{"update:visible":function(t){e.editVisible=t}}},[r("el-form",{attrs:{"label-width":"120px"}},[r("el-form-item",{attrs:{label:"配置名称",required:""}},[r("el-input",{attrs:{clearable:""},model:{value:e.configure_name,callback:function(t){e.configure_name=t},expression:"configure_name"}})],1),r("el-form-item",{attrs:{label:"编写人员",required:""}},[r("el-input",{attrs:{clearable:""},model:{value:e.author,callback:function(t){e.author=t},expression:"author"}})],1),r("el-form-item",{attrs:{label:"选择项目",required:""}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getInterfacesByProjectID(e.selected_project_id)}},model:{value:e.selected_project_id,callback:function(t){e.selected_project_id=t},expression:"selected_project_id"}},e._l(e.project_names,(function(e,t){return r("el-option",{key:t,attrs:{label:e.projectname,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"选择接口",required:""}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selected_interface_id,callback:function(t){e.selected_interface_id=t},expression:"selected_interface_id"}},e._l(e.interfaces,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},a=[],i=r(2552),l={name:"baseform",data:function(){return{current_configure_id:null,editVisible:!1,apiMsgData:{id:null,name:"",header:[{key:null,value:null}],globalVar:[{key:null,value:null,param_type:"string"}]},bodyShow:"second",otherShow:"first",paramTypes:["string","int","float","boolean"],cell:Object(),project_names:[],selected_project_id:null,selected_interface_id:null,selected_configure_id:null,configure_name:null,author:"",interfaces:[]}},created(){this.current_configure_id=this.$route.params.id,this.getProjectNames(),this.getConfigureDetail()},methods:{onSubmit(){this.editVisible=!0},handleData1(e,t){let r=[];for(let n=0;n<e.length;n++){let a=e[n].key;if(!a)return this.$message.error(t+"的key为空!"),[];let i=e[n].param_type,l=e[n].value;if("int"===i){if(!/^\d+$/.test(l))return this.$message.error(t+"不是整数int类型!"),[];l=Number(l)}else if("float"===i){if(!/^[+-]?\d+(\.\d+)?$/.test(l))return this.$message.error(t+"不是小数float类型!"),[];l=Number(l)}else if("boolean"===i)if(/^(true|True|TRUE|1|0)$/.test(l))l=!0;else{if(!/^(false|False|FALSE|0)$/.test(l))return this.$message.error(t+"不是布尔boolean类型!"),[];l=!1}let s={};s[a]=l,r.push(s)}return r},handleData2(e,t){let r={};for(let n=0;n<e.length;n++){let a=e[n].key;if(!a)return this.$message.error(t+"的key为空!"),[];r[a]=e[n].value}return r},saveEdit(){if(null===this.configure_name)return void this.$message.error("配置名称不能为空!");if(""===this.author)return void this.$message.error("编写人员名称不能为空!");if(null===this.selected_project_id||null===this.selected_interface_id)return void this.$message.error("未选择所属项目或者接口!");let e={name:this.configure_name,interface:{pid:this.selected_project_id,iid:this.selected_interface_id},author:this.author,request:{config:{name:this.configure_name,request:{}}}},t=this.apiMsgData.globalVar;if(t.splice(-1,1),0!==t.length){let r=this.handleData1(t,"全局变量variables");if(0===r.length)return;e.request.config["variables"]=r}let r=this.apiMsgData.header;if(r.splice(-1,1),0!==r.length){let t=this.handleData2(r,"请求头header");if(0===t.length)return;e.request.config.request["headers"]=t}e.include=JSON.stringify(e.include),e.request=JSON.stringify(e.request),(0,i.$q)(this.current_configure_id,e).then((e=>{this.editVisible=!1,this.$message.success("更新成功")})).catch((e=>{this.editVisible=!1,"object"===typeof e&&e.hasOwnProperty("name")?(console.log(e),this.$message.error("更新配置失败")):(console.log(e),this.$message.error("服务器错误"))}))},getProjectNames(){(0,i.o)().then((e=>{this.project_names=e.data.data})).catch((e=>{that.$message.error("服务器错误")}))},getInterfacesByProjectID(e){(0,i.nk)({id:e}).then((e=>{this.interfaces=e.data.data})).catch((e=>{that.$message.error("服务器错误")}))},changeResult(){let e=this.selected.length,t="[";for(let r=0;r<e;r++)t+=r===e-1?this.selected[r].id+"]":this.selected[r].id+", ";0===e&&(t="[]"),this.selected_testcase_id=JSON.parse(t)},delTableRow(e,t){"variable"===e?this.apiMsgData.variable.splice(t,1):"header"===e?this.apiMsgData.header.splice(t,1):"globalVar"===e&&this.apiMsgData.globalVar.splice(t,1)},addTableRow(e){"variable"===e?this.apiMsgData.variable.push({key:null,value:null,param_type:"string"}):"header"===e?this.apiMsgData.header.push({key:null,value:null}):"globalVar"===e&&this.apiMsgData.globalVar.push({key:null,value:null,param_type:"string"})},tempNum(e){this.temp_num=e},resetLine(){this.cell.style.height="18px"},showLine(e,t){this.cell=document.getElementById(e+t),this.cell.style.height=this.cell.scrollHeight+"px"},changeLine(){if(this.cell.style.height!==this.cell.scrollHeight+"px"){let e=parseInt(this.cell.style.height.substring(0,this.cell.style.height.length-2));e-this.cell.scrollHeight===2?this.cell.style.height=e-18+"px":this.cell.style.height=this.cell.scrollHeight+"px"}},getConfigureDetail(){(0,i.Vx)(this.current_configure_id).then((e=>{console.log(e),this.configure_name=e.data.configure_name,this.author=e.data.author,this.selected_project_id=e.data.selected_project_id,this.getInterfacesByProjectID(this.selected_project_id),this.selected_interface_id=e.data.selected_interface_id,this.apiMsgData.globalVar=e.data.globalVar,this.apiMsgData.header=e.data.header})).catch((e=>{this.$message.error("服务器错误")}))}},computed:{monitorHeader(){return this.apiMsgData.header},monitorGlobalVar(){return this.apiMsgData.globalVar}},watch:{monitorHeader:{handler:function(){0===this.apiMsgData.header.length&&this.addTableRow("header"),(this.apiMsgData.header[this.apiMsgData.header.length-1]["key"]||this.apiMsgData.header[this.apiMsgData.header.length-1]["value"])&&this.addTableRow("header")},deep:!0},monitorGlobalVar:{handler:function(){0===this.apiMsgData.globalVar.length&&this.addTableRow("globalVar"),(this.apiMsgData.globalVar[this.apiMsgData.globalVar.length-1]["key"]||this.apiMsgData.globalVar[this.apiMsgData.globalVar.length-1]["value"])&&this.addTableRow("globalVar")},deep:!0}}},s=l,o=r(1001),u=(0,o.Z)(s,n,a,!1,null,"24cc2316",null),c=u.exports},2552:function(e,t,r){r.d(t,{$8:function(){return te},$q:function(){return P},AH:function(){return se},AZ:function(){return y},B:function(){return d},Bx:function(){return N},Cs:function(){return X},DC:function(){return T},Dr:function(){return ce},FP:function(){return m},G3:function(){return U},GL:function(){return de},GW:function(){return _e},IG:function(){return g},KL:function(){return re},Kh:function(){return $e},Kq:function(){return ye},L$:function(){return c},LO:function(){return j},Lu:function(){return Y},NM:function(){return ie},NV:function(){return o},NW:function(){return x},OM:function(){return ee},PT:function(){return v},QG:function(){return De},RB:function(){return S},RD:function(){return je},RQ:function(){return M},Sp:function(){return me},TR:function(){return Q},Tg:function(){return oe},Tj:function(){return ge},Vx:function(){return W},W7:function(){return J},WD:function(){return b},XC:function(){return E},Z4:function(){return B},ZH:function(){return L},Zf:function(){return _},_X:function(){return f},ah:function(){return ae},aj:function(){return w},ay:function(){return q},cQ:function(){return ve},cu:function(){return fe},d9:function(){return l},ei:function(){return le},iO:function(){return D},ie:function(){return V},in:function(){return K},jJ:function(){return h},jh:function(){return be},kJ:function(){return pe},kq:function(){return A},lO:function(){return we},n:function(){return p},nL:function(){return z},nk:function(){return C},nq:function(){return $},ny:function(){return I},o:function(){return R},pU:function(){return Z},pW:function(){return he},s2:function(){return ue},tK:function(){return k},tc:function(){return ke},th:function(){return u},vi:function(){return ne},vj:function(){return H},x4:function(){return s},xQ:function(){return O},yr:function(){return G},z:function(){return F}});var n=r(4206),a=r.n(n);let i="http://kk.uoyo.net:8080";const l=e=>a().get(`${i}/project/list/?page=`+e.page+"&size="+e.size,e),s=e=>a().post(`${i}/project/detail/`,e),o=(e,t)=>a().put(`${i}/project/edit/`+e+"/",t),u=e=>a()["delete"](`${i}/project/delete/`+e+"/"),c=e=>a().post(`${i}/project/deleteall/`,e),d=e=>a().post(`${i}/project/add/`,e),p=()=>a().get(`${i}/interface/project/name`),f=()=>a().get(`${i}/project/get/env/`),h=e=>a().post(`${i}/project/run/`,e),g=e=>a().post(`${i}/interface/add/`,e),m=e=>a().get(`${i}/interface/list/?page=`+e.page+"&size="+e.size,e),b=(e,t)=>a().put(`${i}/interface/edit/`+e+"/",t),$=e=>a()["delete"](`${i}/interface/delete/`+e+"/"),y=e=>a().post(`${i}/interface/deleteall/`,e),_=e=>a().post(`${i}/interface/detail/`,e),v=()=>a().get(`${i}/interface/env/`),k=e=>a().post(`${i}/interface/run/`,e),w=e=>a().get(`${i}/env/list/?page=`+e.page+"&size="+e.size,e),j=(e,t)=>a().put(`${i}/env/edit/`+e+"/",t),D=e=>a()["delete"](`${i}/env/delete/`+e+"/"),V=e=>a().post(`${i}/env/add/`,e),z=e=>a().post(`${i}/env/detail/`,e),M=e=>a().post(`${i}/env/deleteall/`,e),x=e=>a().get(`${i}/debugtalk/list/?page=`+e.page+"&size="+e.size,e),S=e=>a().post(`${i}/debugtalk/detail/`,e),q=e=>a().get(`${i}/debugtalk/code/`+e+"/"),T=e=>a().put(`${i}/debugtalk/update/`,e),R=()=>a().get(`${i}/config/project/name/`),C=e=>a().post(`${i}/config/interface/name/`,e),N=e=>a().post(`${i}/config/save/`,e),O=e=>a().get(`${i}/config/list/?page=`+e.page+"&size="+e.size,e),L=e=>a().post(`${i}/config/detail/`,e),H=e=>a()["delete"](`${i}/config/delete/`+e+"/"),I=e=>a().post(`${i}/config/deleteall/`,e),W=e=>a().get(`${i}/config/detail/`+e+"/"),P=(e,t)=>a().put(`${i}/config/update/`+e+"/",t),B=()=>a().get(`${i}/testsuite/project/name/`),G=e=>a().post(`${i}/testsuite/interface/name/`,e),E=e=>a().post(`${i}/testsuite/add/`,e),K=e=>a().get(`${i}/testsuite/list/?page=`+e.page+"&size="+e.size,e),J=e=>a().post(`${i}/testsuite/detail/`,e),Z=e=>a().get(`${i}/testsuite/detail/`+e+"/"),F=(e,t)=>a().put(`${i}/testsuite/update/`+e+"/",t),Q=e=>a().post(`${i}/testsuite/deleteall/`,e),A=e=>a()["delete"](`${i}/testsuite/delete/`+e+"/"),U=()=>a().get(`${i}/testcase/project/name/`),X=e=>a().post(`${i}/testcase/interface/name/`,e),Y=e=>a().post(`${i}/testcase/configure/name/`,e),ee=e=>a().post(`${i}/testcase/name/`,e),te=e=>a().post(`${i}/testcase/add/`,e),re=e=>a().get(`${i}/testcase/list/?page=`+e.page+"&size="+e.size),ne=e=>a().post(`${i}/testcase/detail/`,e),ae=e=>a()["delete"](`${i}/testcase/delete/`+e+"/"),ie=e=>a().post(`${i}/testcase/deleteall/`,e),le=e=>a().get(`${i}/testcase/get/detail/`+e+"/"),se=e=>a().put(`${i}/testcase/update/`,e),oe=()=>a().get(`${i}/testcase/get/env/`),ue=e=>a().post(`${i}/testcase/run/`,e),ce=e=>a().get(`${i}/report/list/?page=`+e.page+"&size="+e.size),de=e=>a().get(`${i}/report/view/`+e+"/"),pe=e=>a().post(`${i}/report/download/`+e+"/"),fe=e=>a()["delete"](`${i}/report/delete/`+e+"/"),he=e=>a().post(`${i}/report/deleteall/`,e),ge=e=>a().post(`${i}/report/open/`,e),me=()=>a().get(`${i}/summary/data/`),be=e=>a().post(`${i}/repository/add/`,e),$e=e=>a().get(`${i}/repository/list/?page=`+e.page+"&size="+e.size),ye=e=>a().post(`${i}/repository/detail/`,e),_e=e=>a().put(`${i}/repository/update/`,e),ve=e=>a()["delete"](`${i}/repository/delete/`+e+"/"),ke=e=>a().post(`${i}/repository/deleteall/`,e),we=e=>a().post(`${i}/repository/search/`,e),je=e=>a().post(`${i}/repository/git/`,e),De=e=>a().post(`${i}/repository/compile/`,e)}}]);
//# sourceMappingURL=891.21a6377f.js.map