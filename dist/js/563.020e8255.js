"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[563],{4563:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"crumbs"},[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[n("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 套件管理")]),n("el-breadcrumb-item",[e._v("编辑套件")])],1)],1),n("div",{staticClass:"container"},[n("div",{staticClass:"form-box"},[n("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"套件名称",prop:"name"}},[n("el-input",{attrs:{"suffix-icon":"el-icon-menu",clearable:""},on:{focus:function(t){return e.clearValidate("name")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"选择项目",prop:"project_id"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getInterfacesByProjectID(e.form.project_id)}},model:{value:e.form.project_id,callback:function(t){e.$set(e.form,"project_id",t)},expression:"form.project_id"}},e._l(e.project_names,(function(e,t){return n("el-option",{key:t,attrs:{label:e.projectname,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"选择接口"}},[n("div",{staticClass:"drag-box"},[n("div",{staticClass:"drag-box-item"},[n("div",{staticClass:"item-title"},[e._v("待选接口")]),n("draggable",{attrs:{options:e.dragOptions},on:{change:function(t){return e.unchangeResult()}},model:{value:e.unselected,callback:function(t){e.unselected=t},expression:"unselected"}},[n("transition-group",{staticClass:"item-ul",attrs:{tag:"div"}},e._l(e.unselected,(function(t){return n("div",{key:t.id,staticClass:"drag-list"},[e._v(" "+e._s(t.name)+" ")])})),0)],1)],1),n("div",{staticClass:"drag-box-item"},[n("div",{staticClass:"item-title"},[e._v("已选接口")]),n("draggable",{attrs:{options:e.dragOptions},on:{change:function(t){return e.changeResult()}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[n("transition-group",{staticClass:"item-ul",attrs:{tag:"div"}},e._l(e.selected,(function(t){return n("div",{key:t.id,staticClass:"drag-list"},[e._v(" "+e._s(t.name)+" ")])})),0)],1)],1)])]),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")]),n("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("取消")])],1)],1)],1)])])},s=[],i=n(9980),o=n.n(i),u=n(2552),a={beforeRouteUpdate(e,t,n){this.current_testsuite_id=e.params.id,this.getTestSuiteDetail(),n()},name:"baseform",data:function(){return{current_testsuite_id:null,form:{name:"",project_id:"",include:""},rules:{name:[{required:!0,message:"请输入套件名称",trigger:"blur"}],project_id:[{required:!0,message:"请选择所属项目",trigger:"blur"}]},project_names:[],dragOptions:{animation:120,scroll:!0,group:"sortlist",ghostClass:"ghost-style"},unselected:[],selected:[],selected_ids:"",unselected_ids:""}},components:{draggable:o()},created(){this.current_testsuite_id=this.$route.params.id,this.getProjectNames(),this.getTestSuiteDetail()},methods:{onSubmit(e){this.$refs[e].validate((e=>{if(!e)return this.$message.error("参数有误"),!1;{let e=this,t={include:this.selected_ids,uninclude:this.unselected_ids};this.form.include=JSON.stringify(t),(0,u.z)(this.current_testsuite_id,this.form).then((e=>{this.$message.success("修改套件成功！")})),e.$router.push("/testsuites_list").catch((e=>{e.response.data.hasOwnProperty("name")?this.$message.error("套件名称已存在"):this.$message.error("服务器错误")}))}}))},clearValidate(e){this.$refs["form"].clearValidate(e)},resetForm(e){this.$refs[e].resetFields()},getProjectNames(){(0,u.Z4)().then((e=>{this.project_names=e.data.data})).catch((e=>{that.$message.error("服务器错误")}))},removeHandle(e){console.log(e),this.$message.success(`从 ${e.from.id} 移动到 ${e.to.id} `)},getInterfacesByProjectID(e){(0,u.yr)({id:e}).then((e=>{let t=e.data.data;this.unselected=[...t,...this.selected],t.forEach((e=>{this.selected.forEach((t=>{e.name===t.name&&(this.unselected.splice(this.unselected.findIndex((t=>t.name===e.name)),1),this.unselected.splice(this.unselected.findIndex((e=>e.name===t.name)),1))}))}))})).catch((e=>{that.$message.error("服务器错误")}))},changeResult(){for(var e=this.selected.length,t="[",n=0;n<e;n++)t+=n===e-1?this.selected[n].id+"]":this.selected[n].id+", ";0===e&&(t="[]"),this.selected_ids=t},unchangeResult(){for(var e=this.unselected.length,t="[",n=0;n<e;n++)t+=n===e-1?this.unselected[n].id+"]":this.unselected[n].id+", ";0===e&&(t="[]"),this.unselected_ids=t},getTestSuiteDetail(){(0,u.pU)(this.current_testsuite_id).then((e=>{console.log(e.data),this.form.name=e.data.name,this.form.project_id=e.data.project_id,this.getInterfacesByProjectID(this.form.project_id),this.selected=e.data.include})).catch((e=>{this.$message.error("服务器错误")}))}}},c=a,l=n(1001),d=(0,l.Z)(c,r,s,!1,null,"76057398",null),f=d.exports},2552:function(e,t,n){n.d(t,{$8:function(){return te},$q:function(){return V},AH:function(){return ue},AZ:function(){return _},B:function(){return d},Bx:function(){return w},Cs:function(){return X},DC:function(){return S},Dr:function(){return le},FP:function(){return $},G3:function(){return M},GL:function(){return de},GW:function(){return be},IG:function(){return m},KL:function(){return ne},Kh:function(){return ve},Kq:function(){return _e},L$:function(){return l},LO:function(){return z},Lu:function(){return Y},NM:function(){return ie},NV:function(){return a},NW:function(){return O},OM:function(){return ee},PT:function(){return j},QG:function(){return Ce},RB:function(){return R},RD:function(){return ze},RQ:function(){return I},Sp:function(){return $e},TR:function(){return U},Tg:function(){return ae},Tj:function(){return me},Vx:function(){return G},W7:function(){return E},WD:function(){return h},XC:function(){return K},Z4:function(){return W},ZH:function(){return L},Zf:function(){return b},_X:function(){return p},ah:function(){return se},aj:function(){return k},ay:function(){return P},cQ:function(){return je},cu:function(){return pe},d9:function(){return o},ei:function(){return oe},iO:function(){return C},ie:function(){return x},in:function(){return Q},jJ:function(){return g},jh:function(){return he},kJ:function(){return fe},kq:function(){return A},lO:function(){return ke},n:function(){return f},nL:function(){return D},nk:function(){return q},nq:function(){return v},ny:function(){return Z},o:function(){return T},pU:function(){return H},pW:function(){return ge},s2:function(){return ce},tK:function(){return y},tc:function(){return ye},th:function(){return c},vi:function(){return re},vj:function(){return N},x4:function(){return u},xQ:function(){return B},yr:function(){return F},z:function(){return J}});var r=n(4206),s=n.n(r);let i="http://kk.uoyo.net:8080";const o=e=>s().get(`${i}/project/list/?page=`+e.page+"&size="+e.size,e),u=e=>s().post(`${i}/project/detail/`,e),a=(e,t)=>s().put(`${i}/project/edit/`+e+"/",t),c=e=>s()["delete"](`${i}/project/delete/`+e+"/"),l=e=>s().post(`${i}/project/deleteall/`,e),d=e=>s().post(`${i}/project/add/`,e),f=()=>s().get(`${i}/interface/project/name`),p=()=>s().get(`${i}/project/get/env/`),g=e=>s().post(`${i}/project/run/`,e),m=e=>s().post(`${i}/interface/add/`,e),$=e=>s().get(`${i}/interface/list/?page=`+e.page+"&size="+e.size,e),h=(e,t)=>s().put(`${i}/interface/edit/`+e+"/",t),v=e=>s()["delete"](`${i}/interface/delete/`+e+"/"),_=e=>s().post(`${i}/interface/deleteall/`,e),b=e=>s().post(`${i}/interface/detail/`,e),j=()=>s().get(`${i}/interface/env/`),y=e=>s().post(`${i}/interface/run/`,e),k=e=>s().get(`${i}/env/list/?page=`+e.page+"&size="+e.size,e),z=(e,t)=>s().put(`${i}/env/edit/`+e+"/",t),C=e=>s()["delete"](`${i}/env/delete/`+e+"/"),x=e=>s().post(`${i}/env/add/`,e),D=e=>s().post(`${i}/env/detail/`,e),I=e=>s().post(`${i}/env/deleteall/`,e),O=e=>s().get(`${i}/debugtalk/list/?page=`+e.page+"&size="+e.size,e),R=e=>s().post(`${i}/debugtalk/detail/`,e),P=e=>s().get(`${i}/debugtalk/code/`+e+"/"),S=e=>s().put(`${i}/debugtalk/update/`,e),T=()=>s().get(`${i}/config/project/name/`),q=e=>s().post(`${i}/config/interface/name/`,e),w=e=>s().post(`${i}/config/save/`,e),B=e=>s().get(`${i}/config/list/?page=`+e.page+"&size="+e.size,e),L=e=>s().post(`${i}/config/detail/`,e),N=e=>s()["delete"](`${i}/config/delete/`+e+"/"),Z=e=>s().post(`${i}/config/deleteall/`,e),G=e=>s().get(`${i}/config/detail/`+e+"/"),V=(e,t)=>s().put(`${i}/config/update/`+e+"/",t),W=()=>s().get(`${i}/testsuite/project/name/`),F=e=>s().post(`${i}/testsuite/interface/name/`,e),K=e=>s().post(`${i}/testsuite/add/`,e),Q=e=>s().get(`${i}/testsuite/list/?page=`+e.page+"&size="+e.size,e),E=e=>s().post(`${i}/testsuite/detail/`,e),H=e=>s().get(`${i}/testsuite/detail/`+e+"/"),J=(e,t)=>s().put(`${i}/testsuite/update/`+e+"/",t),U=e=>s().post(`${i}/testsuite/deleteall/`,e),A=e=>s()["delete"](`${i}/testsuite/delete/`+e+"/"),M=()=>s().get(`${i}/testcase/project/name/`),X=e=>s().post(`${i}/testcase/interface/name/`,e),Y=e=>s().post(`${i}/testcase/configure/name/`,e),ee=e=>s().post(`${i}/testcase/name/`,e),te=e=>s().post(`${i}/testcase/add/`,e),ne=e=>s().get(`${i}/testcase/list/?page=`+e.page+"&size="+e.size),re=e=>s().post(`${i}/testcase/detail/`,e),se=e=>s()["delete"](`${i}/testcase/delete/`+e+"/"),ie=e=>s().post(`${i}/testcase/deleteall/`,e),oe=e=>s().get(`${i}/testcase/get/detail/`+e+"/"),ue=e=>s().put(`${i}/testcase/update/`,e),ae=()=>s().get(`${i}/testcase/get/env/`),ce=e=>s().post(`${i}/testcase/run/`,e),le=e=>s().get(`${i}/report/list/?page=`+e.page+"&size="+e.size),de=e=>s().get(`${i}/report/view/`+e+"/"),fe=e=>s().post(`${i}/report/download/`+e+"/"),pe=e=>s()["delete"](`${i}/report/delete/`+e+"/"),ge=e=>s().post(`${i}/report/deleteall/`,e),me=e=>s().post(`${i}/report/open/`,e),$e=()=>s().get(`${i}/summary/data/`),he=e=>s().post(`${i}/repository/add/`,e),ve=e=>s().get(`${i}/repository/list/?page=`+e.page+"&size="+e.size),_e=e=>s().post(`${i}/repository/detail/`,e),be=e=>s().put(`${i}/repository/update/`,e),je=e=>s()["delete"](`${i}/repository/delete/`+e+"/"),ye=e=>s().post(`${i}/repository/deleteall/`,e),ke=e=>s().post(`${i}/repository/search/`,e),ze=e=>s().post(`${i}/repository/git/`,e),Ce=e=>s().post(`${i}/repository/compile/`,e)}}]);
//# sourceMappingURL=563.020e8255.js.map